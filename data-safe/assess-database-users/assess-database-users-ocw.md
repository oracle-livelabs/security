# Assess Database Users

## Introduction

User Assessment helps you assess the security of your database users and identify potential high risk users. By default, Oracle Data Safe automatically generates user assessments for your target databases and stores them in the Assessment History. You can analyze assessment data across all your target databases and for each target database. You can monitor security drift on your target databases by comparing the latest assessment to a baseline or to another assessment.

In this lab, you explore User Assessment.

Estimated Lab Time: 20 minutes

### Objectives

In this lab, you will:

- View the dashboard for User Assessment
- Analyze users in the latest user assessment
- Generate suspicious activity on the target database
- Refresh the latest user assessment and rename it
- View the user assessment history for your target database
- Compare the latest user assessment with the initial user assessment


### Prerequisites

This lab assumes you have:

- Obtained an Oracle Cloud account and signed in to the Oracle Cloud Infrastructure Console
- Prepared your environment for this workshop (see [Prepare Your Environment](?lab=prepare-environment))
- Registered your target database with Oracle Data Safe (see [Register an Autonomous Database with Oracle Data Safe](?lab=register-autonomous-database))


### Assumptions

- Your data values are most likely different than those shown in the screenshots.


## Task 1: View the dashboard for User Assessment

1. Navigate to **User Assessment**. To do this, in the breadcrumb at the top of the page, click **Security Center**. On the left, click **User Assessment**.

2. Under **List Scope**, make sure your compartment is selected. Deselect **Include child compartments**.

3. At the top of the dashboard, review the four charts.

    - The **User Risk** chart shows you the number and percentage of users who are potentially **Critical Risk**, **High Risk**, **Medium Risk**, and **Low Risk**.
    - The **User Roles** chart shows you the number of users with the **DBA**, **DV Admin**, and **Audit Admin** roles.
    - The **Last Password Change** chart shows you the number and percentage of users who changed their passwords within the last 30 days, within the last 30-90 days, and 90 days ago or more.
    - The **Last Login** chart shows you the number and percentage of users that signed in to the target database within the last 24 hours, within the last week, within the current month, within the current year, and a year ago or more.

    ![User Assessment dashboard charts](images/ua-dashboard-charts.png "User Assessment dashboard charts")

4. Review the **Risk Summary** tab.

    - The **Risk Summary** tab focuses on potential risks across all selected target databases. It shows you potential risk levels, the number of target databases, the number of users at each risk level, and counts for DBAs, DV Admins, and Audit Admins.
    - Potential risk levels are categorized as **Critical**, **High**, **Medium**, and **Low**.

    ![User Assessment Risk Summary tab](images/ua-risk-summary-tab.png "User Assessment Risk Summary tab")

5. Click the **Target Summary** tab. This tab provides the following information:

    - Number of critical and high risk users, DBAs, DV Admins, and Audit Admins
    - Date and time of the latest user assessment
    - Whether the latest user assessment deviates from the baseline (if one is set)

    ![User Assessment Target Summary tab](images/ua-target-summary-tab.png "User Assessment Target Summary tab")


## Task 2: Analyze users in the latest user assessment

The latest user assessment is the one that was automatically generated by Oracle Data Safe when you registered your target database.

1. On the **Target Summary** tab, click **View Report** to view the latest user assessment for your target database.

2. At the top of the report on the **Overview** tab, review the **User Risks**, **User Roles**, **Last Password Change**, and **Last Login** charts.

    ![User Assessment Latest charts](images/ua-latest-charts.png "User Assessment Latest charts")

3. Click the **Assessment Information** tab and review the details.

4. Scroll down and review the **Assessment Details** section. This table provides the following information about each user:

    - User name
    - User type (for example, PRIVILEGED, SCHEMA)
    - Whether the user is a DBA, DV Admin, or Audit Admin
    - Potential risk level (for example, LOW, HIGH, or CRITICAL)
    - User's status (for example, OPEN, LOCKED, or EXPIRED\_AND\_LOCKED)
    - Date and time the user last logged in to the target database
    - Audit records for the user

    ![User Assessment latest assessment details](images/ua-latest-assessment-details.png "User Assessment latest assessment details")

5. In the **User Name** column, click a user that is a **CRITICAL** potential risk, for example, **EVIL_RICH**.

    The **User Details** panel shows the following information about the user:

    - User name
    - Target database name
    - Date and time when the user was created
    - Potential risk level - Hover over the question mark to view what constitutes a critical risk user.
    - User type
    - User profile
    - Privileged roles (the Admin roles granted to the user)
    - Last login date and time
    - Roles - Expand **All Roles** to view all the roles granted to the user.
    - Privileges - Expand **All Privileges** to view all the privileges granted to the user.

    ![ADMIN user details](images/ua-admin-user-details.png "ADMIN user details")

6. Click **Close**.

7. Notice at the top of the table that you can set filters. Click **+ Add Filter**. From the first drop-down list, select **Potential Risk**. From the second drop-down list, select **=**. In the **Value** box, enter **CRITICAL**. Click **Apply**. The table now shows you only potentially critical risk users.

    ![Critical risk users filter](images/ua-critical-risk-users-filter.png "Critical risk users filter")

8. To remove the filter, click the **X** next to the filter.


## Task 3: Generate suspicious activity on the target database

1. Access the SQL worksheet in **Database Actions**.

2. If needed, clear the worksheet and the **Script Output** tab.

3. On the SQL worksheet, enter the following commands:

    ```
    <copy>DROP USER evil_rich;
    CREATE USER joe_smith identified by Oracle123_Oracle123;
    GRANT PDB_DBA to joe_smith;</copy>
    ```

4. On the toolbar, click the **Run Script** button (green circle with a white arrow) to execute the query.

    ![Run Script button](images/run-script.png "Run Script button")

5. On the **Script Output** tab at the bottom of the page, verify that the `EVIL_RICH` user is dropped, the `JOE_SMITH` user is created, and the grant is successful.


## Task 4: Refresh the latest user assessment and rename it

1. Return to the browser tab for Oracle Data Safe. You last left off on the **User Assessment Details** page for the latest user assessment.

2. Click the **Refresh Now** button.

    ![User Assessment Refresh Now button](images/ua-refresh-now-button.png "User Assessment Refresh Now button")

3. In the **Refresh Now** panel, keep the default name as is, and click **Refresh Now**. Wait for the status of the latest user assessment to read as **SUCCEEDED**. Oracle Data Safe automatically saves a static copy of it to the Assessment History.

    ![User Assessment Refresh Now panel](images/ua-refresh-now-panel.png "User Assessment Refresh Now panel")

4. Review the refreshed latest assessment.

5. Click the **Assessment Information** tab, and then click the **Pencil** icon next to the assessment name. Change the name to **Latest User Assessment**, and then click the **Save** icon. Wait for the status to change from **UPDATING** to **SUCCEEDED**. The name is updated on the page.

    ![Renamed latest user assessment](images/ua-renamed-latest-assessment.png "Renamed latest user assessment")


## Task 5: View the user assessment history for your target database

1. At the top of the **Latest User Assessment** page, click **View History**.

2. Make sure that your compartment is selected. Deselect **Include child compartments**.

3. Review the list of assessments.

4. Click **Close** to return to the latest user assessment.

    If you navigated away from the latest user assessment, you can return to it by doing the following: Click **User Assessment** in the breadcrumb. Click the **Target Summary** tab. Click **View Report** for your target database.


## Task 6: Compare the latest user assessment with the initial user assessment

You can select a user assessment to compare with the latest user assessment. With this option, you don't need to set a baseline. This option is only available when you are viewing the latest user assessment.

1. While viewing the latest user assessment, on the left under **Resources**, click **Compare Assessments**.

    ![User Assessment Compare Assessments option](images/ua-compare-assessments-option.png "User Assessment Compare Assessments option")

2. Scroll down to the **Comparison with Other Assessments** section.

3. If your compartment isn't shown, click **Change Compartment** and select your compartment.

4. From the **Select Assessment** drop-down list, select the initial assessment for your target database (second one in the list). As soon as you select it, the comparison operation is started.

5. Review the **Comparison** report.

    - The report tells you that there is a new user added and a user deleted.
    - The New User finding is identified as a potential **CRITICIAL** risk.

    ![User Assessment Comparison report](images/ua-comparison-report2.png "User Assessment Comparison report")

6. In the **Comparison Results** column, click one of the **Open Details** links to view more information.

    The **Comparison Details** panel is displayed.

    ![Comparison Details panel](images/ua-comparison-details-panel.png "Comparison Details panel")

7. Review the information, and then click **Close**. At this point, you might consider setting a baseline assessment again.




## Learn More

- [User Assessment Overview](https://www.oracle.com/pls/topic/lookup?ctx=en/cloud/paas/data-safe&id=UDSCS-GUID-6BF46EE2-F7B5-4710-A09C-069EA95F8052)

## Acknowledgements

* **Author** - Jody Glover, Consulting User Assistance Developer, Database Development
* **Last Updated By/Date** - Jody Glover, Aug 24, 2022
